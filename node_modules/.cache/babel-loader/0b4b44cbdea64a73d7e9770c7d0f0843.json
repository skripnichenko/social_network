{"ast":null,"code":"import _regeneratorRuntime from\"/home/skripnichenko/social_network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/skripnichenko/social_network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/home/skripnichenko/social_network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/home/skripnichenko/social_network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{stopSubmit}from'redux-form';import{profileAPI,usersAPI}from'./../API/api';var ADD_POST='ADD-POST';var SET_USER_PROFILE='SET_USER_PROFILE';var SET_STATUS='SET_STATUS';var SAVE_PHOTO_SUCCESS='SAVE_PHOTO_SUCCESS';var initialState={postsData:[{id:1,message:'Hi, how are you?',likesCount:14},{id:2,message:'It is my first post',likesCount:3}],profile:null,status:''};var profileReducer=function profileReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case ADD_POST:return _objectSpread(_objectSpread({},state),{},{postsData:[].concat(_toConsumableArray(state.postsData),[{id:5,message:action.newPostText,likesCount:0}])});case SET_USER_PROFILE:{return _objectSpread(_objectSpread({},state),{},{profile:action.profile});}case SAVE_PHOTO_SUCCESS:{return _objectSpread(_objectSpread({},state),{},{profile:_objectSpread(_objectSpread({},state.profile),{},{photos:action.photos})});}case SET_STATUS:{return _objectSpread(_objectSpread({},state),{},{status:action.status});}default:return state;};};export var addPostActionCreator=function addPostActionCreator(newPostText){return{type:ADD_POST,newPostText:newPostText};};export var setUserProfile=function setUserProfile(profile){return{type:SET_USER_PROFILE,profile:profile};};export var setStatus=function setStatus(status){return{type:SET_STATUS,status:status};};export var savePhotoSuccess=function savePhotoSuccess(photos){return{type:SAVE_PHOTO_SUCCESS,photos:photos};};export var getUserProfile=function getUserProfile(userId){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return usersAPI.getProfile(userId);case 2:response=_context.sent;dispatch(setUserProfile(response.data));case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var getStatus=function getStatus(userId){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return profileAPI.getStatus(userId);case 2:response=_context2.sent;dispatch(setStatus(response.data));case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var updateStatus=function updateStatus(status){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return profileAPI.updateStatus(status);case 3:response=_context3.sent;if(response.data.resultCode===0){dispatch(setStatus(status));};_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);alert('Some error occured');case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[0,8]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var savePhoto=function savePhoto(file){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return profileAPI.savePhoto(file);case 2:response=_context4.sent;if(response.data.resultCode===0){dispatch(savePhotoSuccess(response.data.data.photos));};case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var saveProfile=function saveProfile(profile){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch,getState){var userId,response;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:userId=getState().auth.userId;_context5.next=3;return profileAPI.saveProfile(profile);case 3:response=_context5.sent;if(!(response.data.resultCode===0)){_context5.next=8;break;}dispatch(getUserProfile(userId));_context5.next=10;break;case 8:dispatch(stopSubmit('edit-profile',{_error:response.data.messages}));return _context5.abrupt(\"return\",Promise.reject(response.data.messages));case 10:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x5,_x6){return _ref5.apply(this,arguments);};}();};export default profileReducer;","map":{"version":3,"sources":["/home/skripnichenko/social_network/src/redux/profile-reducer.js"],"names":["stopSubmit","profileAPI","usersAPI","ADD_POST","SET_USER_PROFILE","SET_STATUS","SAVE_PHOTO_SUCCESS","initialState","postsData","id","message","likesCount","profile","status","profileReducer","state","action","type","newPostText","photos","addPostActionCreator","setUserProfile","setStatus","savePhotoSuccess","getUserProfile","userId","dispatch","getProfile","response","data","getStatus","updateStatus","resultCode","alert","savePhoto","file","saveProfile","getState","auth","_error","messages","Promise","reject"],"mappings":"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","sourcesContent":["import { stopSubmit } from 'redux-form';\nimport { profileAPI, usersAPI } from './../API/api'\n\nconst ADD_POST = 'ADD-POST';\nconst SET_USER_PROFILE = 'SET_USER_PROFILE';\nconst SET_STATUS = 'SET_STATUS';\nconst SAVE_PHOTO_SUCCESS = 'SAVE_PHOTO_SUCCESS';\n\nlet initialState = {\n    postsData: [\n        { id: 1, message: 'Hi, how are you?', likesCount: 14 },\n        { id: 2, message: 'It is my first post', likesCount: 3 }\n    ],\n    profile: null,\n    status: '',\n};\n\nconst profileReducer = (state = initialState, action) => {\n    switch (action.type) {\n        case ADD_POST:\n            return {\n                ...state,\n                postsData: [...state.postsData, {\n                    id: 5,\n                    message: action.newPostText,\n                    likesCount: 0,\n                }],\n            }\n        case SET_USER_PROFILE: {\n            return { ...state, profile: action.profile }\n        }\n        case SAVE_PHOTO_SUCCESS: {\n            return { ...state, profile: { ...state.profile, photos: action.photos } }\n        }\n        case SET_STATUS: {\n            return { ...state, status: action.status }\n        }\n        default:\n            return state;\n    };\n};\n\n\n\nexport const addPostActionCreator = (newPostText) => ({ type: ADD_POST, newPostText });\nexport const setUserProfile = (profile) => ({ type: SET_USER_PROFILE, profile })\nexport const setStatus = (status) => ({ type: SET_STATUS, status });\nexport const savePhotoSuccess = (photos) => ({ type: SAVE_PHOTO_SUCCESS, photos });\n\n\n\nexport const getUserProfile = (userId) => async (dispatch) => {\n    const response = await usersAPI.getProfile(userId);\n    dispatch(setUserProfile(response.data));\n};\n\nexport const getStatus = (userId) => async (dispatch) => {\n    const response = await profileAPI.getStatus(userId);\n    dispatch(setStatus(response.data));\n};\n\nexport const updateStatus = (status) => async (dispatch) => {\n    try {\n        const response = await profileAPI.updateStatus(status);\n        if (response.data.resultCode === 0) {\n            dispatch(setStatus(status));\n        };\n    } catch (error) {\n        alert('Some error occured')\n    }\n\n};\n\nexport const savePhoto = (file) => async (dispatch) => {\n\n    const response = await profileAPI.savePhoto(file);\n    if (response.data.resultCode === 0) {\n        dispatch(savePhotoSuccess(response.data.data.photos));\n    };\n};\n\nexport const saveProfile = (profile) => async (dispatch, getState) => {\n    const userId = getState().auth.userId;\n    const response = await profileAPI.saveProfile(profile);\n    if (response.data.resultCode === 0) {\n        dispatch(getUserProfile(userId));\n    } else {\n        dispatch(stopSubmit('edit-profile', { _error: response.data.messages }));\n        return Promise.reject(response.data.messages);\n    }\n};\n\nexport default profileReducer;"]},"metadata":{},"sourceType":"module"}